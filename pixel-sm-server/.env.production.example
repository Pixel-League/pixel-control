# Production deployment template for pixel-sm-server.
#
# Usage:
#   cp .env.production.example .env.production.local
#   docker compose --env-file .env.production.local -f docker-compose.yml -f docker-compose.production.yml up -d --build
#
# Do not commit populated env files.

# Optional Compose project isolation for production-like hosts.
COMPOSE_PROJECT_NAME=pixel-sm-production

# --- MySQL credentials (secrets: must be changed) ---
MYSQL_ROOT_PASSWORD=CHANGE_ME_PROD_ROOT_PASSWORD
MYSQL_DATABASE=pixel_control
MYSQL_APP_USER=pixel_control
MYSQL_APP_PASSWORD=CHANGE_ME_PROD_APP_PASSWORD

# --- Runtime mount paths (must stay outside ../ressources/*) ---
PIXEL_SM_RUNTIME_SOURCE=./runtime/server
PIXEL_SM_TITLEPACKS_SOURCE=./TitlePacks
PIXEL_SM_MAPS_SOURCE=./maps
PIXEL_CONTROL_PLUGIN_SOURCE=../pixel-control-plugin/src

# --- Image/runtime compatibility ---
PIXEL_SM_RUNTIME_PLATFORM=linux/amd64

# --- Log retention and graceful stop windows ---
PIXEL_SM_LOG_MAX_SIZE=20m
PIXEL_SM_LOG_MAX_FILE=10
PIXEL_SM_MYSQL_STOP_GRACE_PERIOD=60s
PIXEL_SM_SHOOTMANIA_STOP_GRACE_PERIOD=120s

# --- Dedicated server ports ---
PIXEL_SM_XMLRPC_PORT=5000
PIXEL_SM_GAME_PORT=2350
PIXEL_SM_P2P_PORT=3450

# --- Dedicated server identity (secrets: login/password must be changed) ---
PIXEL_SM_SERVER_NAME=pixel-sm-production
PIXEL_SM_DEDICATED_LOGIN=CHANGE_ME_DEDICATED_LOGIN
PIXEL_SM_DEDICATED_PASSWORD=CHANGE_ME_DEDICATED_PASSWORD

# --- Mode selection ---
PIXEL_SM_TITLE_PACK=SMStormElite@nadeolabs
# Presets: elite | siege | battle | joust | custom
PIXEL_SM_MODE=elite
# Leave empty to use preset fallback (<mode>.txt); set explicit filename/path to override.
PIXEL_SM_MATCHSETTINGS=

# --- ManiaControl credentials (secrets: must be changed) ---
PIXEL_SM_MANIACONTROL_SUPERADMIN_PASSWORD=CHANGE_ME_PROD_SUPERADMIN_PASSWORD
PIXEL_SM_MANIACONTROL_ADMIN_PASSWORD=CHANGE_ME_PROD_ADMIN_PASSWORD
PIXEL_SM_MANIACONTROL_USER_PASSWORD=CHANGE_ME_PROD_USER_PASSWORD
# Optional: single ManiaPlanet login promoted to ManiaControl MasterAdmin on render.
PIXEL_SM_MANIACONTROL_MASTERADMIN_LOGIN=
PIXEL_SM_MANIACONTROL_LOG_LEVEL=info

# --- Bootstrap behavior ---
PIXEL_SM_BOOTSTRAP_TIMEOUT_SECONDS=180
PIXEL_SM_START_MANIACONTROL=1

# --- Pixel Control transport ---
PIXEL_CONTROL_AUTO_ENABLE=1
# Set to your API endpoint (use HTTPS in production).
PIXEL_CONTROL_API_BASE_URL=https://CHANGE_ME_API_BASE_URL
PIXEL_CONTROL_API_EVENT_PATH=/plugin/events
PIXEL_CONTROL_API_TIMEOUT_SECONDS=10
PIXEL_CONTROL_API_MAX_RETRY_ATTEMPTS=5
PIXEL_CONTROL_API_RETRY_BACKOFF_MS=500
PIXEL_CONTROL_QUEUE_MAX_SIZE=5000
PIXEL_CONTROL_DISPATCH_BATCH_SIZE=5
PIXEL_CONTROL_HEARTBEAT_INTERVAL_SECONDS=120

# Authentication defaults are intentionally conservative for compatibility.
# Configure a stronger mode/value pair before internet exposure.
PIXEL_CONTROL_AUTH_MODE=none
PIXEL_CONTROL_AUTH_VALUE=CHANGE_ME_OPTIONAL_AUTH_VALUE
PIXEL_CONTROL_AUTH_HEADER=X-Pixel-Control-Api-Key

PIXEL_CONTROL_LINK_SERVER_URL=https://CHANGE_ME_LINK_SERVER_URL
PIXEL_CONTROL_LINK_TOKEN=CHANGE_ME_LINK_TOKEN

# --- Optional veto defaults ---
PIXEL_CONTROL_VETO_DRAFT_ENABLED=0
PIXEL_CONTROL_VETO_DRAFT_COMMAND=pcveto
PIXEL_CONTROL_VETO_DRAFT_DEFAULT_MODE=matchmaking_vote
PIXEL_CONTROL_VETO_DRAFT_MATCHMAKING_DURATION_SECONDS=60
PIXEL_CONTROL_VETO_DRAFT_TOURNAMENT_ACTION_TIMEOUT_SECONDS=45
PIXEL_CONTROL_VETO_DRAFT_DEFAULT_BEST_OF=3
PIXEL_CONTROL_VETO_DRAFT_LAUNCH_IMMEDIATELY=1

# --- Optional production healthcheck tuning (used by docker-compose.production.yml) ---
PIXEL_SM_MYSQL_HEALTHCHECK_INTERVAL=10s
PIXEL_SM_MYSQL_HEALTHCHECK_TIMEOUT=5s
PIXEL_SM_MYSQL_HEALTHCHECK_RETRIES=20
PIXEL_SM_MYSQL_HEALTHCHECK_START_PERIOD=20s
PIXEL_SM_SHOOTMANIA_HEALTHCHECK_INTERVAL=10s
PIXEL_SM_SHOOTMANIA_HEALTHCHECK_TIMEOUT=5s
PIXEL_SM_SHOOTMANIA_HEALTHCHECK_RETRIES=30
PIXEL_SM_SHOOTMANIA_HEALTHCHECK_START_PERIOD=45s
